clc;clear;
% K_rice = 10;
% parfor ite_num = 1:10
% [P_out(ite_num)] = untitled( K_rice )
% end
% LoS-Only
P1 = [    9.078141086695302e-04   0.001206975444288    0.001533349409708   0.001854670792693    0.002143800359037   0.002279309559373      0.002550976400411     0.002667241641142];
% Proposed
P2 = [0.002294511735511         0.002377365245245    0.002403668933715   0.002603349806705    0.002602215415601     0.002617240740587     0.002636385009646     0.002672213272791];
% Perfect CSI
P3 =  [0.003883532318133  0.004037102930396   0.004111640459800  0.004296004997514  0.004448984031314  0.004681456003671  0.004828296576436 0.004841066761504 ];

Emax = 4.927e-3; E0 = 64e-6; tau1 = 274; tau2 = 0.29;
PHI_EH = @(Pin) max( Emax/exp( -tau1*E0 + tau2 ) * ( ( 1 + exp(-tau1*E0+tau2) )./( 1 + exp(-tau1*Pin+tau2) ) - 1 ) , 0 );
P1 = PHI_EH(P1);
P2 = PHI_EH(P2);
P3 = PHI_EH(P3) * ( 1 - 0.32*4*4*log2(4*1024) / 140 );

figure(2); plot(-4:2:10 , P1 , '-o'  , 'linewidth' , 2 );
hold on; plot(-4:2:10 , P2 , '-v'    , 'linewidth' , 2 );
hold on; plot(-4:2:10 , P3 , '-d'  ,   'linewidth' , 2);
