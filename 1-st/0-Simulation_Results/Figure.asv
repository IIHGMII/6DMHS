clc ; clear ; close all ;


  %% Fig. 1: Transmit power-EH, 对比2DMA，FPA
%发射功率：30:1:45 dBm
%6DMA扇面数：6； 每个RHS的元素个数：32*32；
%莱斯因子：5
Ptx = 30:1:45;
Emax = 4.927e-3; E0 = 0.0064e-3; tau1 = 274; tau2 = 0.29;
PHI_EH = @(Pin) max( Emax/exp( -tau1*E0 + tau2 ) * ( ( 1 + exp(-tau1*E0+tau2) )./( 1 + exp(-tau1*Pin+tau2) ) - 1 ) , 0 );
% 6DMA，同时优化平移和旋转
P_6DMA = [ 0.000190598730045254	0.000239923533726268	0.000302153003772993	0.000382386033712897	0.000478108559213433	0.000601763446541078	0.000770183399193927	0.000952332383529517	0.00119599557669085 0.00153481 0.00189976 0.00238494 0.00303743 0.00375171 0.00487929 0.00595291];
P_6DMA = 10*log10( PHI_EH(P_6DMA)/1e-3 );

% FPA
P_FPA  = [ 3.59987e-05 4.597e-05 5.81105123513989e-05	7.21568802600625e-05	9.17577590971581e-05	0.000115689968732858	0.000147138510717881	0.000182393456737643	0.000230220466165803	0.000288884542915909	0.000359093681244097	0.000462817035927022	0.000577384277604434	0.000730401858152820	0.000920747240932318	0.00115521641162510 ];
P_FPA  = 10*log10( PHI_EH(P_FPA)/1e-3 );

% 6DMA，只优化平移，不优化旋转
P_TO   = [ 9.30029e-05 0.000117891565738201	0.000148822495098746	0.000188286830363896	0.000237000702863936	0.000299240356224359	0.000377893455227796	0.000476372103039458	0.000600061398009940	0.000756639469848812	0.000951220014961358	0.00120253334034914	0.00151362406381216	0.00190022628901632	0.00240750667220574	0.00302760333604455 ];
P_TO  = 10*log10( PHI_EH(P_TO)/1e-3 );

% 6DMA，只优化旋转
P_RO   = [  0.000132376560257334	0.000167103549549372	0.000210865255123299	0.000265781694129335	0.000335286465843638	0.000422634469453969	0.000532512244778177	0.000670532780472441	0.000845427466539796	0.00106494363738477	0.00134123898593128	0.00168947075357193	0.00212701620069408	0.00269320188960371	0.00337262844653303	0.00425054384285719 ];
P_RO  = 10*log10( PHI_EH(P_RO)/1e-3 );

figure(3); 
plot( Ptx , P_6DMA , '-o' , 'color' , [25 72 156]/256 , 'linewidth' , 2 );
hold on;plot( Ptx , P_RO  , '-v' , 'color' , [231 37 25]/256 , 'linewidth' , 2 );
hold on;plot( Ptx , P_TO  , '-d' , 'color' , [185 159 201]/256 , 'linewidth' , 2 );
hold on;plot( Ptx , P_FPA  , '-s' , 'color' , [113 193 147]/256 , 'linewidth' , 2 );

grid on;
legend( 'Proposed 6DMA' , '6DMA with rotation only' , '6DMA with translation only' , 'FPA' , 'fontsize' , 12 , 'fontname' , 'timesnewroman' , 'location' , 'southeast' )
xlabel( 'Transmit power (dBm)' , 'fontsize' , 12 , 'fontname' , 'timesnewroman' );
ylabel( 'EH power (dBm)' , 'fontsize' , 12 , 'fontname' , 'timesnewroman' );
axis([30 45 -20 5]);
xticks(30:3:45);    yticks(-20:5:5);
box on;

%% Fig. 2: Trade-off, 对比不同感知误差
%无误差
%上行发射功率0.2mW,方差0.005
%上行发射功率0.1mW，方差0.01
%上行发射功率0.05mW,方差0.06
% P0 = [0.00123764635760964	0.00119423288488533	0.00110178916524746	0.00102664520135806	0.000973068926507197	0.000936263977431652	0.000908516261228284	0.000890067750686125	0.000878552058573532	0.000867374245349486	0.000856013054050138	0.000844449659062061	0.000825682245750535	0.000737480254666536	0.000287105949625629	7.25415292194296e-05	2.82478779635999e-08	0	0	0];
% P1 = [0.000566173897002649	0.000546670545399512	0.000465771400423964	0.000423763360137105	0.000397730178553676	0.000380232591253706	0.000366975215612336	0.000358691844986062	0.000352789916321984	0.000347144606517762	0.000341165146245972	0.000326620461827453	0.000315958335459315	0.000210013473576613	2.98075476733302e-05	1.78491517802132e-06	0	0	0	0];
% P2 = [0.000880538278476382	0.000853556100387047	0.000724660047318087	0.000639998280723187	0.000593702376968282	0.000563404031718481	0.000540929353066545	0.000527022231395377	0.000516749436984962	0.000507693508774893	0.000469982890139195	0.000455905596499813	0.000416614521724715	0.000292682375617785	6.10992343390330e-05	3.18384011109931e-06	0	0	0	0];
% P3 = [3.61781395661250e-05	3.06665598116389e-05	1.65627615753894e-05	9.75243393520204e-06	7.22231857407699e-06	6.06349322485349e-06	4.84685555294512e-06	4.24837623257441e-06	4.01698775985386e-06	3.57831529474821e-06	2.82994069004110e-06	1.57424418747216e-06	1.60080752433991e-07	0	0	0	0	0	0	0];


%无误差
P0 = [0.00230555049009775	0.00225010292567540	0.00212225689264841	0.00200780886558690	0.00192265678721690	0.00186173621485415	0.00181738349260611	0.00178216367354857	0.00176503146597107	0.00174695108703070	0.00173180279032037	0.00171197141757212	0.00169283026857875	0.00165081989590456	0.00155271685739499	8.99798073181712e-05];
%MSE = 3.57e-4,RMSE = 0.018894443627691
P1 = [0.00195464499778940	0.00191938688411638	0.00182922546819305	0.00175076359727757	0.00169025502404063	0.00164584174499974	0.00161408811238635	0.00159070340510185	0.00157390561290566	0.00156018769832748	0.00154486950958741	0.00152451279238886	0.00151211337305289	0.00146793971249838	0.00138412782674177	0];
% MSE = 0.0011; RMSE = 0.031;
P2 = [0.00189678889412516	0.00187013322780967	0.00178053281938157	0.00169274497314632	0.00162351379558286	0.00157306070416075	0.00153528494562230	0.00150859205072502	0.00149060571655986	0.00147609066055030	0.00146186699166452	0.00144546685935212	0.00141873563988119	0.00138132109523695	0.00128222792144648	0];
% MSE = 0.007; RMSE = 0.083;
P3 = [0.000114307417387126	0.000107355437764615	7.09641374919613e-05	5.46686036104717e-05	4.69783411051652e-05	4.39806991293168e-05	4.13526543941319e-05	4.04341011649568e-05	3.87742373292339e-05	3.57851563629057e-05	3.07566306943398e-05	1.99577287507151e-05	0	0	0	0];



P0 = 10*log10(PHI_EH(P0)/1e-3);
P1 = 10*log10(PHI_EH(P1)/1e-3);
P2 = 10*log10(PHI_EH(P2)/1e-3);
P3 = 10*log10(PHI_EH(P3)/1e-3);


figure(2);
% plot(1:20,P0,'-o',1:20,P1,'-s',1:20,P2,'-v',1:20,P3,'-d','linewidth',2)
plot( 0:15 , P0 , '-o' , 'color' , [25 72 156]/256 , 'linewidth' , 2 )
hold on; plot( 0:15 , P1 , '-v' , 'color' , [231 37 25]/256 , 'linewidth' , 2 )
hold on; plot( 0:15 , P2 , '-d' , 'color' , [185 159 201]/256 , 'linewidth' , 2 )
% hold on; plot( 0:15 , P3 , '-s' , 'color' , [113 193 147]/256 , 'linewidth' , 2 )
axis([ 0 14 -21 2 ])
grid on;
xlabel('Throughput threshold (bit/s/Hz)','fontsize',12,'fontname','timesnewroman');
ylabel('EH power (dBm)','fontsize',12,'fontname','timesnewroman');
legend( '$\epsilon=0$' , '$\epsilon=0.02$' , '$\epsilon=0.03$' , '$\epsilon=0.08$' , 'fontsize' , 12 , 'interpreter' , 'latex' , 'location' , 'southeast' );%RMSE




% Fig. 3:感知器件铺设间隔 
P_Pro = [0.001764900000000   0.001737670000000   0.000011883188000   0.000011438112000   0.000010789582000];

P_Ben1 = 7.176623833333334e-04 * ones(1,5);
P_Pro  = 10*log10( PHI_EH(P_Pro)/1e-3 );
P_Ben1  = 10*log10( PHI_EH(P_Ben1)/1e-3 );

kappa0 = 0:4;
figure(4); plot(kappa0,P_Pro, '-o' , 'color' , [25 72 156]/256 , 'linewidth' , 2  )
hold on;  plot(kappa0,P_Ben1, '--' , 'color' , [231 37 25]/256 , 'linewidth' , 2  )
axis([ 0 4 -30 5 ]);
xticks([0:1:4]);
yticks([-30:7:5]);
grid on;
box on;
xlabel('Adjustment factor $\kappa$','fontsize',12,'fontname','timesnewroman','Interpreter','latex');
ylabel('EH power (dBm)','fontsize',12,'fontname','timesnewroman');
legend( 'Proposed sensing method' , 'LS-based sensing method' , 'fontsize' , 12 , 'interpreter' , 'latex' , 'location' , 'northeast' )

% % % %B=6
% % % % Fre0 =  [0.0590405904059041	0.245541205412054	0.393296432964330	0.517066420664207	0.615006150061501	0.682810578105781	0.736316113161132	0.772293972939729	0.794741697416974	0.809194341943419	0.817343173431734	0.824723247232472	0.833640836408364	0.838868388683887	0.844095940959410	0.847785977859779	0.853013530135301	0.856703567035670	0.860701107011070	0.866697416974170	0.870387453874539	0.873001230012300	0.876537515375154	0.878075030750308	0.879612546125461	0.881303813038130	0.883763837638376	0.886531365313653	0.888837638376384	0.891297662976630	0.893450184501845	0.896217712177122	0.898985239852399	0.902521525215252	0.905442804428044	0.908056580565806	0.910824108241082	0.913437884378844	0.916359163591636	0.917896678966790	0.920510455104551	0.921894218942189	0.924507995079951	0.926045510455105	0.928966789667897	0.931734317343174	0.935731857318573	0.938038130381304	0.940498154981550	0.942189421894219	0.943880688806888	0.945571955719557	0.947416974169742	0.948031980319803	0.949108241082411	0.950184501845019	0.951722017220172	0.952952029520295	0.955719557195572	0.957410824108241	0.958640836408364	0.958948339483395	0.959563345633456	0.960485854858549	0.961715867158672	0.962945879458795	0.963560885608856	0.964790897908979	0.965559655596556	0.966943419434194	0.967865928659287	0.968942189421894	0.970018450184502	0.970787207872079	0.972170971709717	0.974169741697417	0.976168511685117	0.977398523985240	0.978321033210332	0.978936039360394	0.979397293972940	0.980166051660517	0.982318573185732	0.982779827798278	0.983702337023370	0.984471094710947	0.985393603936039	0.986931119311193	0.987084870848708	0.987853628536285	0.988468634686347	0.989237392373924	0.990159901599016	0.990774907749078	0.991389913899139	0.992004920049201	0.992004920049201	0.992312423124231	0.993081180811808	0.993081180811808	0.993542435424354	0.994464944649447	0.994772447724477	0.994772447724477	0.995233702337023	0.995387453874539	0.995694956949569	0.995694956949569	0.995848708487085	0.995848708487085	0.996309963099631	0.996309963099631	0.997232472324723	0.997386223862239	0.997539975399754	0.997539975399754	0.997539975399754	0.997539975399754	0.998001230012300	0.998462484624846	0.998769987699877	0.999077490774908	0.999231242312423	0.999538745387454	0.999692496924969	0.999846248462485	1	1	1];
% % % % 
% % % % Fre1 =  [0	0.435000000000000	0.682300000000000	0.796833333333333	0.838733333333333	0.852466666666667	0.858133333333333	0.861133333333333	0.864666666666667	0.867866666666667	0.871233333333333	0.874166666666667	0.876966666666667	0.880233333333333	0.883833333333333	0.886933333333333	0.889700000000000	0.892766666666667	0.895600000000000	0.897733333333333	0.900833333333333	0.903300000000000	0.906033333333333	0.908900000000000	0.911066666666667	0.913666666666667	0.915566666666667	0.917866666666667	0.920133333333333	0.922666666666667	0.925533333333333	0.927900000000000	0.930200000000000	0.932166666666667	0.934433333333333	0.936400000000000	0.938666666666667	0.940233333333333	0.942233333333333	0.944300000000000	0.946033333333333	0.947700000000000	0.949233333333333	0.950466666666667	0.952233333333333	0.953533333333333	0.955133333333333	0.956766666666667	0.958033333333333	0.959300000000000	0.960333333333333	0.961600000000000	0.962366666666667	0.963466666666667	0.964666666666667	0.965933333333333	0.966733333333333	0.967866666666667	0.968966666666667	0.969900000000000	0.970666666666667	0.971500000000000	0.972400000000000	0.973400000000000	0.974133333333333	0.974700000000000	0.975800000000000	0.976500000000000	0.977033333333333	0.977900000000000	0.978800000000000	0.979500000000000	0.979933333333333	0.980600000000000	0.981066666666667	0.981666666666667	0.982200000000000	0.982766666666667	0.983400000000000	0.984066666666667	0.984633333333333	0.985200000000000	0.986033333333333	0.986500000000000	0.987066666666667	0.987500000000000	0.987766666666667	0.988500000000000	0.989000000000000	0.989466666666667	0.990033333333333	0.990466666666667	0.991200000000000	0.991633333333333	0.992033333333333	0.992400000000000	0.992733333333333	0.993000000000000	0.993433333333333	0.993666666666667	0.993900000000000	0.994166666666667	0.994433333333333	0.994533333333333	0.995133333333333	0.995433333333333	0.995533333333333	0.995866666666667	0.996033333333333	0.996133333333333	0.996433333333333	0.996800000000000	0.997166666666667	0.997333333333333	0.997466666666667	0.997666666666667	0.997866666666667	0.998033333333333	0.998166666666667	0.998433333333333	0.998633333333333	0.998833333333333	0.999233333333333	0.999366666666667	0.999433333333333	0.999600000000000	0.999733333333333	0.999833333333333	0.999866666666667];
% % % 
% % % % Fre2 =  [0	0.433583333333333	0.685777777777778	0.798416666666667	0.842250000000000	0.856416666666667	0.862944444444444	0.867555555555556	0.872138888888889	0.876722222222222	0.881222222222222	0.885194444444444	0.888805555555556	0.892361111111111	0.896138888888889	0.899500000000000	0.903000000000000	0.906222222222222	0.909583333333333	0.913500000000000	0.916888888888889	0.920222222222222	0.923000000000000	0.926416666666667	0.929666666666667	0.932277777777778	0.934472222222222	0.937027777777778	0.939611111111111	0.941666666666667	0.943722222222222	0.945916666666667	0.947805555555556	0.949638888888889	0.951944444444445	0.954083333333333	0.955888888888889	0.957722222222222	0.959194444444445	0.960555555555556	0.962111111111111	0.963444444444444	0.964916666666667	0.966305555555556	0.967694444444444	0.968777777777778	0.970055555555556	0.970888888888889	0.971944444444445	0.973194444444445	0.974250000000000	0.975055555555556	0.975972222222222	0.976722222222222	0.977777777777778	0.978722222222222	0.979555555555556	0.980111111111111	0.980805555555556	0.981388888888889	0.981972222222222	0.982666666666667	0.983305555555556	0.983750000000000	0.984194444444445	0.984666666666667	0.985027777777778	0.985416666666667	0.985944444444444	0.986388888888889	0.986805555555556	0.987250000000000	0.987750000000000	0.988222222222222	0.989027777777778	0.989388888888889	0.989833333333333	0.990083333333333	0.990250000000000	0.990750000000000	0.991083333333333	0.991388888888889	0.991833333333333	0.992027777777778	0.992444444444445	0.992833333333333	0.993194444444445	0.993555555555556	0.993833333333333	0.994027777777778	0.994305555555556	0.994555555555556	0.994611111111111	0.994638888888889	0.994805555555556	0.995111111111111	0.995250000000000	0.995444444444445	0.995722222222222	0.995944444444444	0.996250000000000	0.996555555555556	0.997000000000000	0.997277777777778	0.997416666666667	0.997583333333333	0.997694444444444	0.997805555555556	0.998000000000000	0.998111111111111	0.998166666666667	0.998222222222222	0.998583333333333	0.998750000000000	0.998944444444444	0.999027777777778	0.999111111111111	0.999166666666667	0.999222222222222	0.999333333333333	0.999416666666667	0.999583333333333	0.999611111111111	0.999666666666667	0.999777777777778	0.999805555555556	0.999888888888889	0.999916666666667	0.999916666666667];
% % % 
% % % % Fre3 =  [0	0.0122000000000000	0.0222000000000000	0.0320833333333333	0.0421333333333333	0.0527500000000000	0.0632333333333333	0.0740333333333333	0.0856333333333333	0.0964500000000000	0.107266666666667	0.117316666666667	0.126500000000000	0.135133333333333	0.143933333333333	0.152783333333333	0.162450000000000	0.171333333333333	0.180383333333333	0.189333333333333	0.196800000000000	0.203516666666667	0.210666666666667	0.217916666666667	0.224800000000000	0.232416666666667	0.239116666666667	0.245266666666667	0.251616666666667	0.258133333333333	0.264866666666667	0.271633333333333	0.278083333333333	0.285783333333333	0.293600000000000	0.301200000000000	0.308683333333333	0.315900000000000	0.323500000000000	0.331883333333333	0.338600000000000	0.345566666666667	0.353083333333333	0.360216666666667	0.367400000000000	0.374266666666667	0.380850000000000	0.388116666666667	0.395133333333333	0.402316666666667	0.409533333333333	0.416933333333333	0.424383333333333	0.430766666666667	0.437500000000000	0.444516666666667	0.452216666666667	0.458983333333333	0.465450000000000	0.472183333333333	0.478500000000000	0.487666666666667	0.497250000000000	0.507200000000000	0.516166666666667	0.525316666666667	0.536866666666667	0.548716666666667	0.560666666666667	0.569633333333333	0.576966666666667	0.586450000000000	0.595566666666667	0.606600000000000	0.618950000000000	0.633200000000000	0.648633333333333	0.663716666666667	0.677033333333333	0.687850000000000	0.699566666666667	0.712116666666667	0.724066666666667	0.735166666666667	0.744650000000000	0.755200000000000	0.766783333333333	0.777566666666667	0.788816666666667	0.800166666666667	0.809550000000000	0.817516666666667	0.825600000000000	0.834033333333333	0.841133333333333	0.848916666666667	0.856783333333333	0.864450000000000	0.871783333333333	0.880783333333333	0.890100000000000	0.897566666666667	0.904083333333333	0.910750000000000	0.916750000000000	0.923083333333333	0.928716666666667	0.934116666666667	0.939300000000000	0.944300000000000	0.948683333333333	0.952383333333333	0.956200000000000	0.959983333333333	0.964500000000000	0.968216666666667	0.970633333333333	0.972766666666667	0.974650000000000	0.976950000000000	0.978850000000000	0.981816666666667	0.984483333333333	0.986716666666667	0.988416666666667	0.989800000000000	0.990966666666667	0.991650000000000	0.992550000000000];
% % % 
% % % % Fre4 =  [0	0.0109000000000000	0.0221166666666667	0.0335666666666667	0.0461500000000000	0.0577500000000000	0.0699000000000000	0.0823000000000000	0.0932500000000000	0.104183333333333	0.114833333333333	0.125083333333333	0.135666666666667	0.145550000000000	0.155833333333333	0.166250000000000	0.176100000000000	0.186533333333333	0.197600000000000	0.208283333333333	0.218700000000000	0.229900000000000	0.240800000000000	0.252450000000000	0.263950000000000	0.274533333333333	0.285800000000000	0.296333333333333	0.307650000000000	0.318133333333333	0.328966666666667	0.339483333333333	0.349566666666667	0.359350000000000	0.369283333333333	0.378566666666667	0.388050000000000	0.398100000000000	0.409066666666667	0.420800000000000	0.432416666666667	0.443966666666667	0.453000000000000	0.461816666666667	0.470133333333333	0.478616666666667	0.487683333333333	0.497533333333333	0.507116666666667	0.516400000000000	0.524883333333333	0.533166666666667	0.541400000000000	0.550966666666667	0.559166666666667	0.567483333333333	0.575633333333333	0.583133333333333	0.591233333333333	0.599216666666667	0.607000000000000	0.616000000000000	0.624183333333333	0.631566666666667	0.639516666666667	0.648200000000000	0.656666666666667	0.666200000000000	0.676133333333333	0.685316666666667	0.693850000000000	0.701833333333333	0.709716666666667	0.716250000000000	0.722783333333333	0.728616666666667	0.734950000000000	0.741666666666667	0.750750000000000	0.760166666666667	0.768633333333333	0.777333333333333	0.785183333333333	0.792566666666667	0.800616666666667	0.809083333333333	0.816850000000000	0.823183333333333	0.830233333333333	0.835666666666667	0.841033333333333	0.846550000000000	0.851950000000000	0.857716666666667	0.862816666666667	0.868066666666667	0.872950000000000	0.878133333333333	0.882666666666667	0.887266666666667	0.891166666666667	0.894466666666667	0.898916666666667	0.903316666666667	0.907716666666667	0.912500000000000	0.917400000000000	0.922550000000000	0.927566666666667	0.931950000000000	0.935750000000000	0.939850000000000	0.943966666666667	0.947883333333333	0.952300000000000	0.956450000000000	0.960316666666667	0.962966666666667	0.966650000000000	0.970200000000000	0.973050000000000	0.975450000000000	0.977900000000000	0.980083333333333	0.981683333333333	0.983616666666667	0.985000000000000	0.986583333333333	0.988166666666667];
% % % 
% % % % Fre5 =  [0	0.0128166666666667	0.0263333333333333	0.0394333333333333	0.0521833333333333	0.0646000000000000	0.0768666666666667	0.0904166666666667	0.104033333333333	0.116750000000000	0.130533333333333	0.143883333333333	0.156900000000000	0.169733333333333	0.182766666666667	0.195466666666667	0.207333333333333	0.219933333333333	0.232466666666667	0.245666666666667	0.258016666666667	0.270900000000000	0.283083333333333	0.295050000000000	0.306816666666667	0.316783333333333	0.327066666666667	0.337116666666667	0.347850000000000	0.358216666666667	0.368583333333333	0.378933333333333	0.388366666666667	0.398766666666667	0.408333333333333	0.418166666666667	0.427516666666667	0.436850000000000	0.446283333333333	0.454950000000000	0.463483333333333	0.472700000000000	0.480683333333333	0.489133333333333	0.497866666666667	0.506500000000000	0.515266666666667	0.524550000000000	0.533583333333333	0.542566666666667	0.551833333333333	0.560000000000000	0.568133333333333	0.576683333333333	0.585966666666667	0.594633333333333	0.602866666666667	0.611500000000000	0.619700000000000	0.628183333333333	0.635816666666667	0.643383333333333	0.651850000000000	0.659566666666667	0.667166666666667	0.674733333333333	0.682483333333333	0.690383333333333	0.699000000000000	0.707650000000000	0.716100000000000	0.723850000000000	0.731366666666667	0.738616666666667	0.746350000000000	0.753183333333333	0.759766666666667	0.766250000000000	0.771983333333333	0.778316666666667	0.784233333333333	0.790533333333333	0.797000000000000	0.802733333333333	0.808750000000000	0.814716666666667	0.821350000000000	0.828066666666667	0.834466666666667	0.840416666666667	0.846483333333333	0.852450000000000	0.858050000000000	0.863716666666667	0.869050000000000	0.873850000000000	0.879166666666667	0.884183333333333	0.888683333333333	0.894066666666667	0.898550000000000	0.903733333333333	0.908700000000000	0.913700000000000	0.919066666666667	0.923866666666667	0.928400000000000	0.932233333333333	0.936900000000000	0.941216666666667	0.945050000000000	0.948400000000000	0.952133333333333	0.955266666666667	0.958400000000000	0.961500000000000	0.964233333333333	0.966983333333333	0.969783333333333	0.972666666666667	0.975100000000000	0.977533333333333	0.979566666666667	0.981750000000000	0.984083333333333	0.986316666666667	0.988716666666667	0.990483333333333	0.991900000000000];
% % % 
% % % %B=7
% % % % Fre0 = [0	0.208000000000000	0.374071428571429	0.508642857142857	0.607928571428571	0.680571428571429	0.733785714285714	0.769500000000000	0.790214285714286	0.807642857142857	0.819428571428571	0.830071428571429	0.838714285714286	0.845428571428571	0.851857142857143	0.857785714285714	0.863428571428571	0.867928571428571	0.872500000000000	0.876642857142857	0.880071428571429	0.884571428571429	0.887357142857143	0.891571428571429	0.894928571428571	0.898357142857143	0.902071428571429	0.906142857142857	0.909071428571429	0.913142857142857	0.917071428571429	0.921357142857143	0.924785714285714	0.929071428571429	0.932357142857143	0.935000000000000	0.937071428571429	0.939571428571429	0.941500000000000	0.942785714285714	0.944000000000000	0.945714285714286	0.947642857142857	0.948500000000000	0.950428571428571	0.952214285714286	0.953785714285714	0.955500000000000	0.957000000000000	0.958571428571429	0.959571428571429	0.960285714285714	0.960928571428572	0.961500000000000	0.962285714285714	0.963000000000000	0.964285714285714	0.965071428571429	0.967142857142857	0.968000000000000	0.969214285714286	0.970071428571429	0.970571428571429	0.971214285714286	0.971357142857143	0.971714285714286	0.972071428571429	0.972714285714286	0.973642857142857	0.974714285714286	0.975428571428571	0.976928571428572	0.977428571428571	0.978285714285714	0.978642857142857	0.979285714285714	0.979928571428572	0.980571428571429	0.981071428571429	0.981500000000000	0.982357142857143	0.983071428571429	0.983857142857143	0.984285714285714	0.984714285714286	0.985428571428571	0.986285714285714	0.986571428571429	0.987071428571429	0.987500000000000	0.988214285714286	0.988571428571429	0.989142857142857	0.989714285714286	0.990214285714286	0.990714285714286	0.991000000000000	0.991500000000000	0.992071428571429	0.992714285714286	0.993357142857143	0.993785714285714	0.994357142857143	0.994714285714286	0.994714285714286	0.995285714285714	0.995785714285714	0.996285714285714	0.997357142857143	0.998000000000000	0.998285714285714	0.998785714285714	0.999285714285714	0.999642857142857	0.999857142857143	1	1	1	1	1	1	1	1	1	1	1	1	1	1];
% % % Fre0 = [0	0.341666666666667	0.615476190476191	0.802380952380952	0.907142857142857	0.955952380952381	0.975000000000000	0.983333333333333	0.984523809523810	0.984523809523810	0.988095238095238	0.988095238095238	0.989285714285714	0.990476190476191	0.990476190476191	0.990476190476191	0.990476190476191	0.990476190476191	0.990476190476191	0.990476190476191	0.990476190476191	0.992857142857143	0.992857142857143	0.992857142857143	0.994047619047619	0.994047619047619	0.994047619047619	0.995238095238095	0.995238095238095	0.995238095238095	0.995238095238095	0.995238095238095	0.995238095238095	0.995238095238095	0.995238095238095	0.995238095238095	0.995238095238095	0.995238095238095	0.995238095238095	0.995238095238095	0.995238095238095	0.995238095238095	0.995238095238095	0.995238095238095	0.995238095238095	0.996428571428571	0.996428571428571	0.996428571428571	0.996428571428571	0.996428571428571	0.996428571428571	0.996428571428571	0.996428571428571	0.996428571428571	0.996428571428571	0.996428571428571	0.996428571428571	0.996428571428571	0.996428571428571	0.996428571428571	0.996428571428571	0.996428571428571	0.996428571428571	0.996428571428571	0.996428571428571	0.996428571428571	0.996428571428571	0.996428571428571	0.996428571428571	0.996428571428571	0.996428571428571	0.996428571428571	0.996428571428571	0.996428571428571	0.996428571428571	0.996428571428571	0.996428571428571	0.996428571428571	0.996428571428571	0.996428571428571	0.996428571428571	0.997619047619048	0.997619047619048	0.997619047619048	0.997619047619048	0.997619047619048	0.997619047619048	0.997619047619048	0.997619047619048	0.997619047619048	0.997619047619048	0.997619047619048	0.997619047619048	0.997619047619048	0.997619047619048	0.997619047619048	0.997619047619048	0.997619047619048	0.998809523809524	0.998809523809524	0.998809523809524	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1];
% % % Fre1 = [0	0.526666666666667	0.811547619047619	0.942500000000000	0.987142857142857	0.994285714285714	0.995476190476191	0.995714285714286	0.995833333333333	0.995833333333333	0.995833333333333	0.995952380952381	0.996071428571429	0.996190476190476	0.996190476190476	0.996309523809524	0.996428571428571	0.996547619047619	0.996666666666667	0.996666666666667	0.997023809523810	0.997023809523810	0.997023809523810	0.997261904761905	0.997380952380952	0.997380952380952	0.997500000000000	0.997738095238095	0.997857142857143	0.997857142857143	0.997857142857143	0.997857142857143	0.997857142857143	0.997857142857143	0.997857142857143	0.997857142857143	0.997857142857143	0.997857142857143	0.997976190476191	0.997976190476191	0.998095238095238	0.998095238095238	0.998095238095238	0.998214285714286	0.998214285714286	0.998214285714286	0.998214285714286	0.998214285714286	0.998214285714286	0.998333333333333	0.998333333333333	0.998452380952381	0.998571428571429	0.998571428571429	0.998571428571429	0.998571428571429	0.998571428571429	0.998690476190476	0.998809523809524	0.998809523809524	0.998928571428571	0.998928571428571	0.998928571428571	0.998928571428571	0.999047619047619	0.999047619047619	0.999047619047619	0.999047619047619	0.999047619047619	0.999047619047619	0.999047619047619	0.999285714285714	0.999285714285714	0.999404761904762	0.999404761904762	0.999404761904762	0.999404761904762	0.999523809523810	0.999523809523810	0.999523809523810	0.999523809523810	0.999523809523810	0.999523809523810	0.999523809523810	0.999523809523810	0.999523809523810	0.999523809523810	0.999523809523810	0.999523809523810	0.999523809523810	0.999523809523810	0.999523809523810	0.999523809523810	0.999523809523810	0.999642857142857	0.999642857142857	0.999642857142857	0.999642857142857	0.999642857142857	0.999642857142857	0.999642857142857	0.999642857142857	0.999642857142857	0.999642857142857	0.999642857142857	0.999642857142857	0.999642857142857	0.999642857142857	0.999642857142857	0.999642857142857	0.999642857142857	0.999642857142857	0.999642857142857	0.999761904761905	0.999761904761905	0.999761904761905	0.999761904761905	0.999761904761905	0.999761904761905	0.999761904761905	0.999761904761905	0.999761904761905	0.999880952380952	0.999880952380952	0.999880952380952	0.999880952380952	0.999880952380952	0.999880952380952	0.999880952380952];
% % % Fre2 = [0	0.516309523809524	0.808571428571429	0.940952380952381	0.980833333333333	0.986547619047619	0.989047619047619	0.989761904761905	0.990000000000000	0.990238095238095	0.990357142857143	0.990476190476191	0.990595238095238	0.990952380952381	0.991071428571429	0.991071428571429	0.991428571428571	0.991785714285714	0.991904761904762	0.992142857142857	0.992261904761905	0.992261904761905	0.992380952380952	0.992500000000000	0.992738095238095	0.992976190476191	0.993095238095238	0.993095238095238	0.993452380952381	0.993809523809524	0.993928571428571	0.994047619047619	0.994047619047619	0.994523809523810	0.994642857142857	0.994761904761905	0.995000000000000	0.995000000000000	0.995119047619048	0.995119047619048	0.995119047619048	0.995238095238095	0.995476190476191	0.995595238095238	0.995595238095238	0.995595238095238	0.995714285714286	0.995952380952381	0.996071428571429	0.996190476190476	0.996190476190476	0.996190476190476	0.996190476190476	0.996190476190476	0.996309523809524	0.996309523809524	0.996547619047619	0.996666666666667	0.996904761904762	0.996904761904762	0.997142857142857	0.997261904761905	0.997261904761905	0.997380952380952	0.997380952380952	0.997500000000000	0.997738095238095	0.997738095238095	0.997857142857143	0.997976190476191	0.998095238095238	0.998095238095238	0.998095238095238	0.998214285714286	0.998214285714286	0.998333333333333	0.998452380952381	0.998690476190476	0.998690476190476	0.998690476190476	0.998809523809524	0.998809523809524	0.998809523809524	0.998809523809524	0.998809523809524	0.998928571428571	0.998928571428571	0.998928571428571	0.999166666666667	0.999404761904762	0.999404761904762	0.999404761904762	0.999404761904762	0.999404761904762	0.999404761904762	0.999404761904762	0.999404761904762	0.999404761904762	0.999404761904762	0.999404761904762	0.999404761904762	0.999404761904762	0.999404761904762	0.999642857142857	0.999880952380952	0.999880952380952	0.999880952380952	0.999880952380952	0.999880952380952	0.999880952380952	0.999880952380952	0.999880952380952	0.999880952380952	0.999880952380952	0.999880952380952	0.999880952380952	0.999880952380952	0.999880952380952	0.999880952380952	0.999880952380952	0.999880952380952	1	1	1	1	1	1	1	1];
% % % Fre3 = [0	0.0108857142857143	0.0209142857142857	0.0309142857142857	0.0426000000000000	0.0577428571428571	0.0715714285714286	0.0847857142857143	0.0976571428571429	0.110257142857143	0.122100000000000	0.133971428571429	0.146271428571429	0.156271428571429	0.167057142857143	0.178614285714286	0.190857142857143	0.202228571428571	0.214357142857143	0.226757142857143	0.238514285714286	0.249657142857143	0.260000000000000	0.268400000000000	0.277128571428571	0.285285714285714	0.293571428571429	0.301528571428571	0.309300000000000	0.317657142857143	0.326085714285714	0.333457142857143	0.343057142857143	0.352342857142857	0.361271428571429	0.370328571428571	0.378542857142857	0.386557142857143	0.394200000000000	0.402400000000000	0.410342857142857	0.419242857142857	0.427542857142857	0.435300000000000	0.443557142857143	0.450214285714286	0.456900000000000	0.463185714285714	0.470128571428571	0.476542857142857	0.482800000000000	0.488728571428571	0.494100000000000	0.499742857142857	0.505100000000000	0.510928571428571	0.516871428571429	0.523100000000000	0.528857142857143	0.536328571428571	0.543185714285714	0.550485714285714	0.558085714285714	0.565100000000000	0.573100000000000	0.580914285714286	0.589757142857143	0.598285714285714	0.606342857142857	0.615014285714286	0.623157142857143	0.632185714285714	0.641871428571429	0.652357142857143	0.662057142857143	0.672271428571429	0.681528571428572	0.690800000000000	0.700657142857143	0.710228571428571	0.719328571428571	0.727657142857143	0.736471428571429	0.745357142857143	0.753885714285714	0.761414285714286	0.769885714285714	0.778271428571429	0.786114285714286	0.794057142857143	0.800885714285714	0.807600000000000	0.815057142857143	0.822085714285714	0.829185714285714	0.835328571428571	0.842700000000000	0.849457142857143	0.855671428571429	0.862200000000000	0.869128571428572	0.874885714285714	0.880871428571429	0.887171428571429	0.893714285714286	0.900471428571429	0.907300000000000	0.914885714285714	0.921057142857143	0.926628571428572	0.933871428571429	0.940342857142857	0.946357142857143	0.952214285714286	0.957300000000000	0.961971428571429	0.965857142857143	0.969157142857143	0.972414285714286	0.975785714285714	0.979285714285714	0.982228571428572	0.984028571428572	0.985385714285714	0.986900000000000	0.988028571428572	0.989628571428571	0.990857142857143	0.991628571428571];
% % % Fre4 = [0	0.0140285714285714	0.0279857142857143	0.0405000000000000	0.0532000000000000	0.0657285714285714	0.0776714285714286	0.0909714285714286	0.104614285714286	0.117585714285714	0.128857142857143	0.139942857142857	0.151085714285714	0.160828571428571	0.171171428571429	0.181957142857143	0.192128571428571	0.203171428571429	0.214371428571429	0.225414285714286	0.236442857142857	0.246871428571429	0.258685714285714	0.270271428571429	0.281628571428571	0.292185714285714	0.302085714285714	0.311871428571429	0.320985714285714	0.330600000000000	0.339971428571429	0.349600000000000	0.358628571428571	0.367600000000000	0.376614285714286	0.385000000000000	0.393600000000000	0.402157142857143	0.410742857142857	0.420000000000000	0.430042857142857	0.440557142857143	0.449742857142857	0.459314285714286	0.467900000000000	0.476300000000000	0.485400000000000	0.493800000000000	0.501857142857143	0.509400000000000	0.516514285714286	0.524900000000000	0.532671428571429	0.541371428571429	0.549457142857143	0.557600000000000	0.566385714285714	0.574342857142857	0.582128571428571	0.589871428571429	0.597971428571429	0.606157142857143	0.613971428571429	0.621557142857143	0.629657142857143	0.639242857142857	0.648900000000000	0.657985714285714	0.666642857142857	0.675257142857143	0.683385714285714	0.691542857142857	0.698242857142857	0.704771428571429	0.711700000000000	0.718557142857143	0.725571428571429	0.732471428571429	0.739157142857143	0.746028571428571	0.752742857142857	0.759900000000000	0.767457142857143	0.774671428571429	0.782014285714286	0.789542857142857	0.796600000000000	0.803842857142857	0.811128571428571	0.817957142857143	0.825271428571429	0.833228571428571	0.841557142857143	0.848685714285714	0.855342857142857	0.861714285714286	0.867771428571429	0.873928571428571	0.879942857142857	0.885842857142857	0.892485714285714	0.898157142857143	0.903471428571429	0.908600000000000	0.912842857142857	0.918071428571429	0.922700000000000	0.926700000000000	0.930471428571429	0.934771428571429	0.938728571428572	0.942428571428571	0.946242857142857	0.950328571428571	0.954200000000000	0.957828571428572	0.960842857142857	0.964328571428571	0.967571428571429	0.970728571428571	0.973257142857143	0.975528571428571	0.977900000000000	0.980414285714286	0.982442857142857	0.984371428571429	0.986228571428572	0.987971428571429	0.989628571428571];
% % % Fre5 = [0	0.0130285714285714	0.0263571428571429	0.0394428571428571	0.0533000000000000	0.0654142857142857	0.0776714285714286	0.0906571428571429	0.102328571428571	0.114185714285714	0.127271428571429	0.140257142857143	0.153100000000000	0.166471428571429	0.179057142857143	0.191485714285714	0.204571428571429	0.217557142857143	0.230714285714286	0.241871428571429	0.253614285714286	0.264671428571429	0.276071428571429	0.288342857142857	0.299828571428571	0.311085714285714	0.322957142857143	0.334614285714286	0.346142857142857	0.357385714285714	0.368757142857143	0.379900000000000	0.391171428571429	0.401157142857143	0.411142857142857	0.420814285714286	0.430085714285714	0.439600000000000	0.449285714285714	0.459200000000000	0.468485714285714	0.477685714285714	0.486828571428571	0.495885714285714	0.504885714285714	0.513585714285714	0.522571428571429	0.531257142857143	0.540071428571429	0.548228571428571	0.556371428571429	0.564328571428571	0.572414285714286	0.580542857142857	0.588885714285714	0.597214285714286	0.605871428571429	0.614714285714286	0.622728571428571	0.630771428571429	0.639285714285714	0.647257142857143	0.655128571428571	0.663071428571429	0.671414285714286	0.679785714285714	0.688457142857143	0.696671428571429	0.704871428571429	0.712042857142857	0.720185714285714	0.727685714285714	0.734428571428571	0.742100000000000	0.749142857142857	0.756042857142857	0.762828571428571	0.769885714285714	0.778342857142857	0.785771428571429	0.792385714285714	0.798757142857143	0.806214285714286	0.813514285714286	0.820257142857143	0.827328571428571	0.833714285714286	0.839700000000000	0.846014285714286	0.852057142857143	0.857614285714286	0.863428571428571	0.868657142857143	0.875271428571429	0.881542857142857	0.887214285714286	0.892414285714286	0.897557142857143	0.902485714285714	0.907242857142857	0.911885714285714	0.916228571428571	0.920442857142857	0.924471428571429	0.928142857142857	0.932357142857143	0.936571428571429	0.940714285714286	0.945171428571429	0.949014285714286	0.952657142857143	0.956371428571429	0.960142857142857	0.963014285714286	0.965571428571429	0.968228571428571	0.970514285714286	0.972500000000000	0.974600000000000	0.976800000000000	0.978757142857143	0.980871428571429	0.982757142857143	0.984642857142857	0.986485714285714	0.988371428571429	0.989828571428571	0.991342857142857	0.992700000000000];
% % % 
% % % figure(5); 
% % % plot( 0 : pi/128 : pi , Fre1 , '-' , 'color' , [25 72 156]/256 , 'linewidth' , 2 )
% % % hold on; plot( 0 : pi/128 : pi , Fre2 , '-' , 'color' , [113 193 147]/256 , 'linewidth' , 2 )
% % % hold on; plot( 0 : pi/128 : pi , Fre3 , '-' , 'color' , [185 159 201]/256 , 'linewidth' , 2 )
% % % hold on; plot( 0 : pi/128 : pi , Fre4 , '-' , 'color' , [228 101 100]/256 , 'linewidth' , 2 )
% % % hold on; plot( 0 : pi/128 : pi , Fre5 , '-' , 'color' , [84 138 202]/256 , 'linewidth' , 2 )
% % % hold on; plot( 0 : pi/128 : pi , Fre0 , '--' , 'color' , [231 37 25]/256 , 'linewidth' , 2 )
% % % 
% % % axis([0,0.5,0,1])
% % % grid on;
% % % xlabel('Sensing error','fontsize',12,'fontname','timesnewroman');
% % % ylabel('CDF','fontsize',12,'fontname','timesnewroman');
% % % legend( 'Proposed sensing method, $\kappa=0$' , 'Proposed sensing method, $\kappa=1$' , 'Proposed sensing method, $\kappa=2$' , 'Proposed sensing method, $\kappa=3$' , 'Proposed sensing method, $\kappa=4$' , 'LS-based sensing method' , 'fontsize' , 12 , 'interpreter' , 'latex' , 'location' , 'northeast' )
% % % 


Fre0 = [0	0.139285714285714	0.470238095238095	0.780952380952381	0.928571428571429	0.966666666666667	0.976190476190476	0.977380952380952	0.978571428571429	0.980952380952381	0.982142857142857	0.982142857142857	0.982142857142857	0.982142857142857	0.982142857142857	0.982142857142857	0.982142857142857	0.982142857142857	0.982142857142857	0.982142857142857	0.982142857142857	0.983333333333333	0.983333333333333	0.983333333333333	0.983333333333333	0.983333333333333	0.983333333333333	0.983333333333333	0.983333333333333	0.983333333333333	0.983333333333333	0.983333333333333	0.983333333333333	0.983333333333333	0.984523809523810	0.985714285714286	0.985714285714286	0.985714285714286	0.985714285714286	0.986904761904762	0.986904761904762	0.986904761904762	0.986904761904762	0.986904761904762	0.986904761904762	0.986904761904762	0.986904761904762	0.986904761904762	0.986904761904762	0.986904761904762	0.986904761904762	0.986904761904762	0.986904761904762	0.986904761904762	0.986904761904762	0.988095238095238	0.988095238095238	0.988095238095238	0.990476190476191	0.990476190476191	0.990476190476191	0.991666666666667	0.991666666666667	0.992857142857143	0.992857142857143	0.992857142857143	0.992857142857143	0.995238095238095	0.996428571428571	0.997619047619048	0.998809523809524	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1];
% Fre1 = [0	0.341985714285714	0.826957142857143	0.985600000000000	0.995357142857143	0.995557142857143	0.995642857142857	0.995728571428571	0.995742857142857	0.995828571428571	0.995900000000000	0.995942857142857	0.995971428571429	0.996028571428571	0.996085714285714	0.996142857142857	0.996185714285714	0.996228571428572	0.996285714285714	0.996342857142857	0.996457142857143	0.996514285714286	0.996557142857143	0.996614285714286	0.996685714285714	0.996814285714286	0.996900000000000	0.996985714285714	0.997028571428571	0.997085714285714	0.997128571428572	0.997242857142857	0.997300000000000	0.997371428571429	0.997414285714286	0.997485714285714	0.997557142857143	0.997585714285714	0.997728571428571	0.997757142857143	0.997828571428571	0.997885714285714	0.997928571428571	0.997971428571429	0.998028571428571	0.998128571428572	0.998142857142857	0.998157142857143	0.998185714285714	0.998242857142857	0.998328571428572	0.998385714285714	0.998414285714286	0.998500000000000	0.998528571428571	0.998600000000000	0.998642857142857	0.998685714285714	0.998728571428571	0.998771428571429	0.998785714285714	0.998814285714286	0.998842857142857	0.998914285714286	0.998942857142857	0.998971428571429	0.999014285714286	0.999085714285714	0.999142857142857	0.999171428571429	0.999214285714286	0.999314285714286	0.999385714285714	0.999442857142857	0.999500000000000	0.999571428571429	0.999614285714286	0.999685714285714	0.999728571428571	0.999828571428571	0.999928571428571	0.999971428571429	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1];
% Fre2 = [0	0.334757142857143	0.814057142857143	0.976642857142857	0.987285714285714	0.987471428571429	0.987671428571429	0.987814285714286	0.988000000000000	0.988228571428572	0.988357142857143	0.988542857142857	0.988771428571429	0.989085714285714	0.989285714285714	0.989485714285714	0.989700000000000	0.989842857142857	0.990014285714286	0.990257142857143	0.990500000000000	0.990714285714286	0.990957142857143	0.991228571428572	0.991400000000000	0.991528571428571	0.991671428571429	0.991785714285714	0.991942857142857	0.992057142857143	0.992200000000000	0.992328571428571	0.992414285714286	0.992542857142857	0.992671428571429	0.992742857142857	0.992914285714286	0.993085714285714	0.993200000000000	0.993357142857143	0.993585714285714	0.993757142857143	0.993900000000000	0.993985714285714	0.994242857142857	0.994414285714286	0.994628571428571	0.994957142857143	0.995114285714286	0.995342857142857	0.995585714285714	0.995728571428571	0.995971428571429	0.996071428571429	0.996228571428572	0.996414285714286	0.996500000000000	0.996528571428571	0.996657142857143	0.996757142857143	0.996900000000000	0.997014285714286	0.997142857142857	0.997285714285714	0.997357142857143	0.997428571428571	0.997557142857143	0.997614285714286	0.997671428571429	0.997757142857143	0.998085714285714	0.998542857142857	0.998671428571429	0.998871428571429	0.999057142857143	0.999185714285714	0.999414285714286	0.999600000000000	0.999700000000000	0.999800000000000	0.999828571428571	0.999900000000000	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1];
% Fre3 = [0	1.42857142857143e-05	8.57142857142857e-05	0.000271428571428571	0.000428571428571429	0.000714285714285714	0.00100000000000000	0.00135714285714286	0.00177142857142857	0.00231428571428571	0.00297142857142857	0.00360000000000000	0.00445714285714286	0.00600000000000000	0.00788571428571429	0.0107000000000000	0.0152142857142857	0.0191142857142857	0.0216142857142857	0.0244285714285714	0.0284857142857143	0.0325000000000000	0.0353285714285714	0.0375000000000000	0.0398571428571429	0.0427285714285714	0.0458142857142857	0.0482142857142857	0.0499571428571429	0.0517857142857143	0.0534285714285714	0.0553571428571429	0.0573142857142857	0.0592857142857143	0.0610428571428571	0.0626000000000000	0.0647857142857143	0.0669428571428571	0.0688428571428571	0.0710000000000000	0.0734285714285714	0.0764000000000000	0.0800857142857143	0.0839857142857143	0.0886142857142857	0.0930000000000000	0.0982714285714286	0.104042857142857	0.109357142857143	0.115928571428571	0.123600000000000	0.131957142857143	0.143400000000000	0.157557142857143	0.173871428571429	0.193385714285714	0.216128571428571	0.238228571428571	0.260985714285714	0.283871428571429	0.309571428571429	0.334971428571429	0.356742857142857	0.379128571428571	0.401357142857143	0.423157142857143	0.445428571428571	0.468828571428571	0.489842857142857	0.513800000000000	0.539300000000000	0.566428571428571	0.595900000000000	0.628628571428571	0.663042857142857	0.693714285714286	0.732328571428571	0.775714285714286	0.822314285714286	0.869300000000000	0.914942857142857	0.974571428571429	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1];
% Fre4 = [0	0.000142857142857143	0.000700000000000000	0.00117142857142857	0.00191428571428571	0.00290000000000000	0.00435714285714286	0.00582857142857143	0.00752857142857143	0.00897142857142857	0.0109571428571429	0.0133428571428571	0.0163571428571429	0.0200285714285714	0.0242428571428571	0.0283714285714286	0.0328857142857143	0.0371428571428571	0.0414428571428571	0.0457857142857143	0.0502857142857143	0.0544000000000000	0.0582571428571429	0.0631428571428571	0.0687428571428572	0.0750857142857143	0.0812428571428571	0.0880000000000000	0.0941285714285714	0.100285714285714	0.105957142857143	0.111885714285714	0.118257142857143	0.124457142857143	0.130742857142857	0.137485714285714	0.144728571428571	0.150528571428571	0.157128571428571	0.164014285714286	0.170971428571429	0.178200000000000	0.185471428571429	0.193128571428571	0.200414285714286	0.207357142857143	0.214514285714286	0.222600000000000	0.231128571428571	0.240914285714286	0.251600000000000	0.263342857142857	0.275614285714286	0.288942857142857	0.304371428571429	0.318928571428571	0.334814285714286	0.354242857142857	0.374057142857143	0.393371428571429	0.411071428571429	0.430185714285714	0.449928571428571	0.471457142857143	0.493600000000000	0.516671428571429	0.538871428571429	0.561428571428571	0.585000000000000	0.610128571428572	0.637800000000000	0.666342857142857	0.699028571428571	0.732400000000000	0.761385714285714	0.789785714285714	0.819842857142857	0.852185714285714	0.887657142857143	0.917414285714286	0.950014285714286	0.984028571428572	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1];
% Fre5 = [0	7.14285714285714e-05	0.000328571428571429	0.00100000000000000	0.00185714285714286	0.00308571428571429	0.00455714285714286	0.00642857142857143	0.00862857142857143	0.0110857142857143	0.0138571428571429	0.0171571428571429	0.0203428571428571	0.0238714285714286	0.0275571428571429	0.0315428571428571	0.0360285714285714	0.0412857142857143	0.0467714285714286	0.0514857142857143	0.0564428571428571	0.0622571428571429	0.0672571428571429	0.0725428571428572	0.0790000000000000	0.0857000000000000	0.0925857142857143	0.0999142857142857	0.106500000000000	0.113671428571429	0.121142857142857	0.129700000000000	0.138242857142857	0.146757142857143	0.155714285714286	0.164900000000000	0.174171428571429	0.183328571428571	0.192185714285714	0.202571428571429	0.213985714285714	0.225200000000000	0.236114285714286	0.247171428571429	0.258871428571429	0.271042857142857	0.282542857142857	0.295485714285714	0.308514285714286	0.322028571428571	0.335542857142857	0.349257142857143	0.364257142857143	0.378257142857143	0.393028571428571	0.408871428571429	0.425300000000000	0.441485714285714	0.457842857142857	0.473914285714286	0.491614285714286	0.509600000000000	0.527642857142857	0.545857142857143	0.566371428571429	0.586671428571429	0.607528571428571	0.629471428571429	0.651342857142857	0.672871428571429	0.693871428571429	0.715457142857143	0.738542857142857	0.765114285714286	0.790328571428571	0.815900000000000	0.842614285714286	0.868871428571429	0.897071428571429	0.926142857142857	0.956057142857143	0.986114285714286	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1];
Fre1 = [0	0.756476190476191	0.969571428571429	0.995714285714286	0.996476190476191	0.996761904761905	0.996904761904762	0.996952380952381	0.997000000000000	0.997000000000000	0.997142857142857	0.997285714285714	0.997476190476191	0.997571428571429	0.997857142857143	0.998000000000000	0.998047619047619	0.998142857142857	0.998238095238095	0.998285714285714	0.998333333333333	0.998428571428571	0.998476190476191	0.998523809523810	0.998523809523810	0.998666666666667	0.998761904761905	0.998761904761905	0.998761904761905	0.998904761904762	0.998904761904762	0.999047619047619	0.999095238095238	0.999095238095238	0.999095238095238	0.999190476190476	0.999285714285714	0.999333333333333	0.999333333333333	0.999380952380952	0.999380952380952	0.999380952380952	0.999380952380952	0.999428571428571	0.999428571428571	0.999476190476191	0.999476190476191	0.999476190476191	0.999523809523810	0.999619047619048	0.999619047619048	0.999619047619048	0.999666666666667	0.999761904761905	0.999761904761905	0.999761904761905	0.999857142857143	0.999857142857143	0.999857142857143	0.999857142857143	0.999857142857143	0.999857142857143	0.999857142857143	0.999904761904762	0.999952380952381	0.999952380952381	0.999952380952381	0.999952380952381	0.999952380952381	0.999952380952381	0.999952380952381	0.999952380952381	0.999952380952381	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1];
Fre2 = [0	0.752666666666667	0.960333333333333	0.986714285714286	0.987952380952381	0.988380952380952	0.989238095238095	0.989809523809524	0.990714285714286	0.991095238095238	0.991666666666667	0.991904761904762	0.992380952380952	0.992666666666667	0.993000000000000	0.993476190476191	0.993714285714286	0.994142857142857	0.994476190476191	0.994619047619048	0.994809523809524	0.995047619047619	0.995238095238095	0.995380952380952	0.995476190476191	0.995619047619048	0.995761904761905	0.996000000000000	0.996095238095238	0.996095238095238	0.996380952380952	0.996523809523810	0.996714285714286	0.996904761904762	0.997142857142857	0.997333333333333	0.997571428571429	0.997714285714286	0.997761904761905	0.997761904761905	0.997857142857143	0.998000000000000	0.998142857142857	0.998285714285714	0.998523809523810	0.998761904761905	0.998761904761905	0.998761904761905	0.998857142857143	0.998857142857143	0.998904761904762	0.998952380952381	0.999000000000000	0.999000000000000	0.999000000000000	0.999000000000000	0.999047619047619	0.999142857142857	0.999190476190476	0.999190476190476	0.999190476190476	0.999238095238095	0.999571428571429	0.999714285714286	0.999761904761905	0.999809523809524	0.999809523809524	0.999809523809524	0.999809523809524	0.999857142857143	0.999857142857143	0.999904761904762	0.999904761904762	0.999952380952381	0.999952380952381	0.999952380952381	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1];
Fre3 = [0	0.0237619047619048	0.0469047619047619	0.0695238095238095	0.0935714285714286	0.114952380952381	0.135000000000000	0.158333333333333	0.178761904761905	0.197285714285714	0.217476190476191	0.238952380952381	0.258714285714286	0.279285714285714	0.297857142857143	0.315523809523810	0.331238095238095	0.346428571428571	0.362619047619048	0.378809523809524	0.395333333333333	0.409142857142857	0.423238095238095	0.437952380952381	0.451571428571429	0.463000000000000	0.475523809523810	0.487809523809524	0.499047619047619	0.511095238095238	0.522571428571429	0.533571428571429	0.544190476190476	0.554809523809524	0.567190476190476	0.577857142857143	0.589190476190476	0.600857142857143	0.613857142857143	0.625523809523810	0.637857142857143	0.650285714285714	0.661047619047619	0.674285714285714	0.684285714285714	0.696619047619048	0.711571428571429	0.721333333333333	0.731714285714286	0.744190476190476	0.757904761904762	0.772952380952381	0.785000000000000	0.797190476190476	0.809285714285714	0.820952380952381	0.832142857142857	0.842333333333333	0.852619047619048	0.861428571428571	0.872285714285714	0.880952380952381	0.888857142857143	0.897476190476190	0.904714285714286	0.912666666666667	0.919095238095238	0.927190476190476	0.933571428571429	0.940000000000000	0.945904761904762	0.951190476190476	0.955857142857143	0.961285714285714	0.966333333333333	0.971761904761905	0.979238095238095	0.983190476190476	0.989523809523810	0.993857142857143	0.996809523809524	0.998952380952381	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1];
Fre4 = [0	0.0236190476190476	0.0457142857142857	0.0674285714285714	0.0877619047619048	0.108380952380952	0.129523809523810	0.151047619047619	0.172714285714286	0.192142857142857	0.212666666666667	0.234333333333333	0.256238095238095	0.275619047619048	0.296190476190476	0.314857142857143	0.332857142857143	0.351809523809524	0.371333333333333	0.388761904761905	0.405952380952381	0.423000000000000	0.438619047619048	0.455047619047619	0.470476190476191	0.486761904761905	0.501428571428571	0.517666666666667	0.533904761904762	0.551095238095238	0.568761904761905	0.585714285714286	0.601428571428571	0.617238095238095	0.630285714285714	0.644238095238095	0.659190476190476	0.672333333333333	0.684190476190476	0.697666666666667	0.708952380952381	0.720428571428571	0.732380952380952	0.743190476190476	0.753952380952381	0.764666666666667	0.774571428571429	0.784142857142857	0.794571428571429	0.805523809523810	0.816047619047619	0.825952380952381	0.835714285714286	0.846428571428571	0.855142857142857	0.864238095238095	0.871714285714286	0.879857142857143	0.888190476190476	0.895761904761905	0.903095238095238	0.909571428571429	0.916285714285714	0.921904761904762	0.927714285714286	0.934904761904762	0.941333333333333	0.948047619047619	0.954571428571429	0.961095238095238	0.966857142857143	0.972047619047619	0.976666666666667	0.980857142857143	0.985238095238095	0.988476190476191	0.991619047619048	0.994523809523810	0.996571428571429	0.998523809523810	0.999571428571429	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1];
Fre5 = [0	0.0241904761904762	0.0472380952380952	0.0708571428571429	0.0963333333333333	0.120238095238095	0.142047619047619	0.163285714285714	0.184571428571429	0.208476190476190	0.230952380952381	0.252190476190476	0.274904761904762	0.295666666666667	0.316523809523810	0.336809523809524	0.355380952380952	0.375047619047619	0.396238095238095	0.414476190476191	0.434190476190476	0.451190476190476	0.468238095238095	0.486190476190476	0.505285714285714	0.520761904761905	0.538047619047619	0.554428571428571	0.571714285714286	0.586952380952381	0.602761904761905	0.618904761904762	0.633904761904762	0.648285714285714	0.662476190476190	0.676380952380952	0.690333333333333	0.704428571428571	0.717238095238095	0.729428571428571	0.741238095238095	0.753333333333333	0.764476190476191	0.776476190476190	0.787142857142857	0.797857142857143	0.808333333333333	0.818523809523810	0.828476190476191	0.837952380952381	0.846428571428571	0.853666666666667	0.862095238095238	0.869238095238095	0.877238095238095	0.884857142857143	0.891761904761905	0.898238095238095	0.904904761904762	0.911714285714286	0.917285714285714	0.922571428571429	0.929619047619048	0.934952380952381	0.941095238095238	0.947761904761905	0.953238095238095	0.958095238095238	0.962904761904762	0.967523809523810	0.971285714285714	0.975095238095238	0.978142857142857	0.981190476190476	0.983857142857143	0.987333333333333	0.990952380952381	0.994095238095238	0.996047619047619	0.997333333333333	0.999142857142857	0.999619047619048	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1];


figure(5); 
plot( 0 : pi/128 : pi , Fre1 , '-' , 'color' , [25 72 156]/256 , 'linewidth' , 1.2 )
hold on; plot( 0 : pi/128 : pi , Fre2 , '-' , 'color' , [113 193 147]/256 , 'linewidth' , 1.2 )
hold on; plot( 0 : pi/128 : pi , Fre3 , '-' , 'color' , [185 159 201]/256 , 'linewidth' , 1.2 )
hold on; plot( 0 : pi/128 : pi , Fre4 , '-' , 'color' , [228 101 100]/256 , 'linewidth' , 1.2 )
hold on; plot( 0 : pi/128 : pi , Fre5 , '-' , 'color' , [84 138 202]/256 , 'linewidth' , 1.2 )
hold on; plot( 0 : pi/128 : pi , Fre0 , '--' , 'color' , [231 37 25]/256 , 'linewidth' , 1.2 )

axis([0,0.5,0,1])
grid on;
xlabel('Sensing error','fontsize',12,'fontname','timesnewroman');
ylabel('CDF','fontsize',12,'fontname','timesnewroman');
legend( 'Proposed sensing method, $\kappa=0$' , 'Proposed sensing method, $\kappa=1$' , 'Proposed sensing method, $\kappa=2$' , 'Proposed sensing method, $\kappa=3$' , 'Proposed sensing method, $\kappa=4$' , 'LS-based sensing method' , 'fontsize' , 12 , 'interpreter' , 'latex' , 'location' , 'northeast' )

% Fig. 4: 发射功率-数能性能，对比馈源位置优化、对比是否对齐最佳方向
% M=64*16，优化馈源位置，最优对齐，发射功率30-45 dBm，有感知误差
P_OPTFeed_OPTAlign = [ 0.000110697827428086	0.000139451024218994	0.000175790866642783	0.000221475780320726	0.000279068775979540	0.000351519139951809	0.000442849348017964	0.000557689943158234	0.000702346288683267	0.000884766651766251	0.00111355434205349	0.00140211154468055	0.00176616079372533	0.00222112108806048	0.00279722274186148	0.00352306579833401 ];
% M=64*16，优化馈源位置，一般对齐[0;0;1]，发射功率30-45 dBm，有感知误差
P_OPTFeed_RandomAlign = [ 9.31982598998642e-05	0.000117261120514070	0.000147842290798038	0.000186137378287813	0.000234467441884817	0.000295289072044230	0.000371935933071415	0.000468280496002872	0.000589646390856119	0.000742771287782766	0.000934970493978669	0.00117693993469609	0.00148178376083078	0.00186600089426398	0.00234931692425040	0.00295744940015716 ];
% M=64*16，随机馈源位置，最优对齐，发射功率30-45 dBm，有感知误差
P_RandomFeed_OPTAlign = [ 9.61926380862966e-05	0.000121103556097565	0.000152439553647256	0.000191950360003183	0.000241612109811795	0.000304193001066866	0.000382941745671352	0.000482020180766541	0.000606754767280259	0.000764396653788082	0.000962562078855077	0.00121190157654759	0.00152551976582805	0.00191890707419139	0.00241515605036326	0.00304084186713801 ];
% M=64*16，随机馈源位置，一般对齐[0;0;1]，发射功率30-45 dBm，有感知误差
P_RandomFeed_RandomAlign = [ 7.70199e-05	9.70330589568605e-05	0.000122202755151761	0.000153874917061061	0.000193642594861326	0.000243896648836809	0.000307061497747420	0.000386595508009619	0.000486668296689172	0.000612524666856628	0.000771191279175290	0.000970917931372506	0.00122223633350654	0.00153872512713788	0.00193696359850579	0.00243868620658671 ];

P_OPTFeed_OPTAlign  = 10*log10( PHI_EH(P_OPTFeed_OPTAlign)/1e-3 );
P_OPTFeed_RandomAlign  = 10*log10( PHI_EH(P_OPTFeed_RandomAlign)/1e-3 );
P_RandomFeed_OPTAlign  = 10*log10( PHI_EH(P_RandomFeed_OPTAlign)/1e-3 );
P_RandomFeed_RandomAlign  = 10*log10( PHI_EH(P_RandomFeed_RandomAlign)/1e-3 );

figure(6); 
plot( 30:45 , P_OPTFeed_OPTAlign , '-' , 'color' , [25,72,156]/256 , 'linewidth' , 2 )
hold on; plot( 30:45 , P_OPTFeed_RandomAlign , '-' , 'color' , [231 37 25]/256 , 'linewidth' , 2 )
hold on; plot( 30:45 , P_RandomFeed_OPTAlign , '--' , 'color' , [185 159 201]/256 , 'linewidth' , 2 )
hold on; plot( 30:45 , P_RandomFeed_RandomAlign , '--' , 'color' , [113 193 147]/256 , 'linewidth' , 2 )

axis([ 30 45 -15 5 ]);
xticks([30:3:45]);
yticks([-15:4:5]);
grid on;
box on;
xlabel('Transmit power (dBm)','fontsize',12,'fontname','timesnewroman','Interpreter','latex');
ylabel('EH power (dBm)','fontsize',12,'fontname','timesnewroman');
legend( 'OPT feed position, OPT angle align' , 'OPT feed position, fixed angle align' , 'Random feed position, OPT angle align' , 'Random feed position, fixed angle align' , 'fontsize' , 12 , 'interpreter' , 'latex' , 'location' , 'southeast' )



% P_Pro  = 10*log10( PHI_EH(P_Pro)/1e-3 );
%% 天线个数-传能性能，改变馈源个数
%馈源个数：1
a1 = [0.00072952  0.00131608  0.00238425  0.00369975   0.00519455];
%馈源个数：2
a2 = [0.000965753  0.00150549  0.00271482  0.00422779  0.0055022];
%馈源个数：4
a3 = [0.00134867  0.00275159  0.0052449   0.0124989    0.0178115];

a1  = 10*log10( PHI_EH(a1)/1e-3 );
a2  = 10*log10( PHI_EH(a2)/1e-3 );
a3  = 10*log10( PHI_EH(a3)/1e-3 );

figure(7); %plot(1:5,a1,'-k',1:5,a2,'--k',1:5,a3,':k','linewidth',2)
plot( 1:5 , a1 , '-' , 'color' , [25 72 156]/256 , 'linewidth' , 2 )
hold on;plot( 1:5 , a2 , '-' , 'color' , [231 37 25]/256 , 'linewidth' , 2 )
hold on;plot( 1:5 , a3 , '-' , 'color' , [185 159 201]/256 , 'linewidth' , 2 )
% axis([ 30 45 -15 5 ]);
xticks([1:1:5]);
% yticks([-15:4:5]);
ax = gca;
set( ax , 'xticklabel' , {'$20\times20$' , '$30\times30$' , '$40\times40$' , '$50\times50$' , '$60\times60$' } ,'TickLabelInterpreter' , 'latex' )
grid on;
box on;
xlabel('The number of the RHS element','fontsize',12,'fontname','timesnewroman','Interpreter','latex');
ylabel('EH power (dBm)','fontsize',12,'fontname','timesnewroman');
legend( '$Q=1$' , '$Q=2$' , '$Q=4$' , 'fontsize' , 12 , 'interpreter' , 'latex' , 'location' , 'southeast' );



























